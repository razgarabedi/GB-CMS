:root { --corner-radius: 10px; }
.theme-dark { --grid-line: rgba(255,255,255,0.09); --panel-bg: #000; --panel-weak: #000; color-scheme: dark; }
.theme-light { --grid-line: rgba(0,0,0,0.08); --panel-bg: #fff; --panel-weak: #f7f7f7; color-scheme: light; }
html, body, #root { height: 100%; width: 100%; margin: 0; padding: 0; }
body { background: #000; color: #fff; font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; }

.kiosk { height: 100%; width: 100%; }
.grid {
  display: grid;
  grid-template-columns: 400px 1fr; /* left sidebar for weather */
  grid-template-rows: 1fr 28vh;   /* bottom slideshow height */
  gap: 2px; /* thin separator lines between modules */
  height: 100%;
  width: 100%;
  padding: 0;
  box-sizing: border-box;
  background: var(--grid-line);
  grid-template-areas:
    "sidebar main"
    "slideshow slideshow";
}
.cell { background: var(--panel-bg); border-radius: var(--corner-radius); overflow: hidden; position: relative; }
.weather { grid-area: sidebar; display: flex; align-items: center; justify-content: center; }
.viewer { grid-area: main; display: flex; align-items: center; justify-content: center; background: var(--panel-bg); }
.slideshow { grid-area: slideshow; background: var(--panel-weak); }
.clock-overlay { position: absolute; left: 12px; bottom: 12px; opacity: 0.95; z-index: 2; pointer-events: none; }

/* 16:9 container for website (fits within box) */
.ratio-16x9 { width: 100%; height: 100%; max-width: 100%; aspect-ratio: 16 / 9; position: relative; }
.ratio-16x9 > * { width: 100%; height: 100%; }

.analog-clock { text-align: center; font-size: 8vmin; }
.analog-clock .tz { font-size: 3vmin; color: #aaa; }
.weather-widget { font-size: 5vmin; }

.web-viewer { border: 0; width: 100%; height: 100%; background: #000; }
.web-viewer.empty { display: flex; align-items: center; justify-content: center; color: #999; }
.snapshot-img { width: 100%; height: auto; min-height: 100%; display: block; background: #000; }

/* Auto-scroll container simulating page scroll via panning */
.auto-scroll { overflow: hidden; }
.auto-scroll .pan-inner {
  position: absolute;
  inset: 0;
  transform-origin: top center;
  /* Keep zoom applied at all times to avoid jump when animation starts */
  transform: scale(var(--pan-zoom, 1.06)) translateY(0);
}
.auto-scroll.run .pan-inner {
  animation: panY var(--pan-duration, 30000ms) ease-in-out 1 forwards;
  animation-delay: var(--pan-delay, 0ms);
}
@keyframes panY {
  0% { transform: scale(var(--pan-zoom, 1.06)) translateY(0); }
  100% { transform: scale(var(--pan-zoom, 1.06)) translateY(calc(var(--pan-distance-px, 0px) * -1)); }
}

/* Fade loop overlay for restart-at-top behavior */
.auto-scroll::after {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  background: #000;
  opacity: 0;
}
.auto-scroll.run::after {
  animation: panFade var(--pan-duration, 30000ms) linear 1 forwards;
  animation-delay: var(--pan-delay, 0ms);
}
@keyframes panFade {
  0% { opacity: 0 }
  92% { opacity: 0 }
  100% { opacity: 1 }
}

.fallback { position: fixed; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.8); padding: 12px; text-align: center; }
.fallback .small { font-size: 12px; color: #aaa; }

/* Vertical 3-column layout */
.grid-vertical-3 {
  display: grid;
  grid-template-columns: 22% 48% 30%;
  grid-template-rows: 100%;
  gap: 2px;
  height: 100%;
  width: 100%;
  padding: 0;
  box-sizing: border-box;
  background: var(--grid-line);
}
.grid-vertical-3 .cell { background: var(--panel-bg); border-radius: var(--corner-radius); overflow: hidden; position: relative; }
.grid-vertical-3 .v-weather { display: flex; flex-direction: column; }
.grid-vertical-3 .v-weather .v-weather-inner { display: grid; grid-template-rows: 1fr auto; height: 100%; }
.grid-vertical-3 .v-weather .v-clock { display: flex; align-items: center; justify-content: center; padding: 8px; }
/* (removed empty rules) */

/* Slideshow layout (like default but smaller bottom strip) */
.grid-slideshow {
  display: grid;
  grid-template-columns: 400px 1fr;
  grid-template-rows: 1fr 18vh; /* smaller bottom area */
  gap: 2px;
  height: 100%;
  width: 100%;
  padding: 0;
  box-sizing: border-box;
  background: var(--grid-line);
  grid-template-areas:
    "sidebar main"
    "slideshow slideshow";
}
.grid-news {
  display: grid;
  grid-template-columns: 400px 1fr;
  grid-template-rows: 1fr 18vh; /* bottom widget only under slideshow */
  gap: 2px;
  height: 100%;
  width: 100%;
  padding: 0;
  box-sizing: border-box;
  background: var(--grid-line);
  grid-template-areas:
    "sidebar main"
    "sidebar bottom";
}
.grid-news .cell { background: var(--panel-bg); border-radius: var(--corner-radius); overflow: hidden; position: relative; }
.grid-news .weather { grid-area: sidebar; display: grid; grid-template-rows: 1fr 1fr; height: 100%; }
.grid-news .viewer { grid-area: main; display: flex; align-items: center; justify-content: center; background: var(--panel-bg); }
.grid-news .bottom { grid-area: bottom; background: var(--panel-weak); }
.grid-news .bottom .bottom-widgets { grid-template-columns: 1fr; justify-items: center; }

@media (max-width: 768px) {
  .grid-news {
    grid-template-columns: 1fr;
    grid-template-rows: auto auto auto;
    grid-template-areas:
      "sidebar"
      "main"
      "bottom";
  }
}
.grid-slideshow .cell { background: var(--panel-bg); border-radius: var(--corner-radius); overflow: hidden; position: relative; }
.grid-slideshow .weather { grid-area: sidebar; display: flex; align-items: center; justify-content: center; }
.grid-slideshow .viewer { grid-area: main; display: flex; align-items: center; justify-content: center; background: var(--panel-bg); }
.grid-slideshow .slideshow { grid-area: slideshow; background: var(--panel-weak); }

/* Welcome text overlay for slideshow layout */
.bottom-widgets { display: grid; grid-template-columns: auto 1fr; align-items: center; gap: 16px; height: 100%; padding: 8px 16px; box-sizing: border-box; }
.bottom-clock { display: flex; align-items: center; justify-content: flex-start; }
.bottom-welcome { text-align: center; color: #fff; font-size: 5vmin; font-weight: 700; text-shadow: 0 2px 6px rgba(0,0,0,0.6); }

/* Slideshow animation */
.slideshow-stack {
  position: absolute;
  inset: 0;
  overflow: hidden;
}
.slide {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  transform-origin: center;
}
.slide.previous {
  animation-name: fadeOut;
  animation-duration: var(--fx, 900ms);
  animation-timing-function: ease;
  animation-fill-mode: forwards;
}
.slide.current {
  animation-name: fadeIn, kenburns;
  animation-duration: var(--fx, 900ms), var(--ken, 18s);
  animation-timing-function: ease, ease-in-out;
  animation-fill-mode: forwards, forwards;
}

/* Additional slideshow animations */
/* cut: hard switch (previous fades quickly, current appears without fade) */
.anim-cut.slide.previous { animation-name: fadeOut; animation-duration: var(--fx, 350ms); animation-timing-function: linear; }
.anim-cut.slide.current { animation-name: none, kenburns; opacity: 1; }

/* wipe: horizontal reveal of the current over the previous */
.anim-wipe.slide.previous { animation-name: fadeOut; }
.anim-wipe.slide.current { animation-name: wipeIn, kenburns; clip-path: inset(0 100% 0 0); }
/* explicit fade tag (optional) */
.anim-fade.slide.previous { animation-name: fadeOut; }
.anim-fade.slide.current { animation-name: fadeIn, kenburns; }
@keyframes wipeIn {
  from { clip-path: inset(0 100% 0 0); }
  to   { clip-path: inset(0 0% 0 0); }
}

@keyframes fadeIn {
  from { opacity: 0 }
  to   { opacity: 1 }
}
@keyframes fadeOut {
  from { opacity: 1 }
  to   { opacity: 0 }
}
/* Ken Burns ends at a slightly larger scale to avoid visible zoom-out before next slide */
@keyframes kenburns {
  0%   { transform: scale(1.04) translate3d(0, 0, 0) }
  100% { transform: scale(1.10) translate3d(0, -1%, 0) }
}

/* Weather widget animations */
.weather-card { 
  will-change: transform, opacity; 
  backface-visibility: hidden; 
}
.weather-card .ww-bg {
  position: absolute;
  inset: 0;
  background-size: cover;
  background-position: center;
  z-index: 0;
}
.weather-card .ww-bg-video {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  z-index: 0;
}
.weather-card .ww-bg-dim {
  position: absolute; inset: 0; z-index: 1; pointer-events: none;
}
.weather-card .ww-bg.ww-bg-animated {
  animation: wwBgPan 40s ease-in-out infinite;
  transform-origin: center;
}
.weather-card .ww-bg.previous { animation: fadeOut 900ms ease forwards; }
.weather-card .ww-bg.current { animation: fadeIn 900ms ease forwards; }
.weather-card .ww-bg-video.previous { animation: fadeOut 900ms ease forwards; filter: brightness(0.92); }
.weather-card .ww-bg-video.current { animation: fadeIn 900ms ease forwards; filter: brightness(0.92); }
.weather-card .ww-location,
.weather-card .ww-main,
.weather-card .ww-forecast {
  position: relative;
  z-index: 2;
}
.weather-anim-fade { animation: wwFadeIn 700ms ease-out both; }
.weather-anim-slide { animation: wwSlideIn 650ms cubic-bezier(.22,.61,.36,1) both; }
.weather-anim-zoom { animation: wwZoomIn 700ms ease-out both; }
.weather-anim-rise { animation: wwRiseIn 700ms ease-out both; }
.weather-anim-tilt { animation: wwTiltIn 720ms cubic-bezier(.22,.61,.36,1) both; }

.weather-card .ww-icon { animation: wwFloat 6s ease-in-out infinite; }
.weather-card .ww-temp { animation: wwPulse 5s ease-in-out infinite; transform-origin: left center; }
.weather-card .ww-desc { opacity: 0.92 }
.weather-card .ww-forecast .day { animation: wwPop 500ms ease-out both; animation-delay: calc(120ms * var(--i)); }

@keyframes wwFadeIn { from { opacity: 0 } to { opacity: 1 } }
@keyframes wwSlideIn { from { opacity: 0; transform: translate3d(-12px, 0, 0) } to { opacity: 1; transform: none } }
@keyframes wwZoomIn { from { opacity: 0; transform: scale(.98) } to { opacity: 1; transform: scale(1) } }
@keyframes wwRiseIn { from { opacity: 0; transform: translate3d(0, 8px, 0) } to { opacity: 1; transform: none } }
@keyframes wwTiltIn { from { opacity: 0; transform: perspective(600px) rotateX(6deg) translateY(8px) } to { opacity: 1; transform: none } }
@keyframes wwFloat { 0%,100% { transform: translateY(0) } 50% { transform: translateY(-4px) } }
@keyframes wwPulse { 0%,100% { transform: scale(1) } 50% { transform: scale(1.02) } }
@keyframes wwPop { from { opacity: 0; transform: scale(.96) } to { opacity: 1; transform: scale(1) } }

/* Endless subtle background motion for animated weather */
@keyframes wwBgPan {
  0% { transform: scale(1.08) translate3d(0, 0, 0); }
  25% { transform: scale(1.10) translate3d(1.5%, -1.5%, 0); }
  50% { transform: scale(1.12) translate3d(0, -2.0%, 0); }
  75% { transform: scale(1.10) translate3d(-1.0%, -1.0%, 0); }
  100% { transform: scale(1.08) translate3d(0, 0, 0); }
}

/* Responsive adjustments */
@media (max-width: 1200px) {
  .grid { grid-template-columns: 320px 1fr; }
  .grid-slideshow { grid-template-columns: 320px 1fr; }
}

@media (max-width: 992px) {
  .grid { grid-template-columns: 280px 1fr; grid-template-rows: 1fr 26vh; }
  .grid-slideshow { grid-template-columns: 280px 1fr; grid-template-rows: 1fr 20vh; }
  .grid-vertical-3 { grid-template-columns: 26% 44% 30%; }
}

@media (max-width: 768px) {
  .grid {
    grid-template-columns: 1fr;
    grid-template-rows: auto auto auto;
    grid-template-areas:
      "sidebar"
      "main"
      "slideshow";
  }
  .grid-slideshow {
    grid-template-columns: 1fr;
    grid-template-rows: auto 22vh;
    grid-template-areas:
      "main"
      "slideshow";
  }
  .grid-vertical-3 {
    grid-template-columns: 1fr;
    grid-template-rows: auto auto auto;
  }
  .grid-vertical-3 .v-weather .v-weather-inner { grid-template-rows: auto auto; }
  .bottom-widgets { grid-template-columns: 1fr; gap: 10px; justify-items: center; text-align: center; }
  .clock-overlay { left: 8px; bottom: 8px; }
  .bottom-welcome { font-size: 6vmin; }
}

@media (max-width: 480px) {
  .grid-slideshow { grid-template-rows: auto 24vh; }
  .weather-widget { font-size: 4.2vmin; }
  .analog-clock .tz { font-size: 2.8vmin; }
}
